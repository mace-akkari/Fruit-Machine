<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>BET MACE</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <section class="container">
        <div class="banner left-banner"><img class="left-img" src="images/Left-banner.png"></div>
        <header class="header">
            <h1>🎰 Slot Machine 🎰</h1>
        </header>
        <main class="main-content">
            <div class="slot-machine">
                <div class="result">Pull for a chance to win!</div>
                <div class="machine-border">
                    <ul>
                        <li class="slot0">🍀</li>
                        <li class="slot1">🍀</li>
                        <li class="slot2">🍀</li>
                    </ul>
                </div>
                <input class="play-button" type="image" src="images/Slot-handle.png" alt="Slot-handle">
            </div>
        </main>
        <div class="banner right-banner"><img class="right-img" src="./images/Right-banner.png"></div>
        <footer class="footer">
            <img class="BetAware" src="images/BetAware-Logo.png" alt="Betting commisions">
            <div>Enjoy the game but play responsibly
                <a href="https://www.begambleaware.org">www.begambleaware.org</a></div>
            <div>🃏BET MACE🃏&#174;</div>
        </footer>
    </section>

    <script>

        const PLAY_URL = '/play';

        const SYMBOLS = [
            '🔔',
            '🍒',
            '🍉'
        ];

        async function play() {
            const response = await fetch(PLAY_URL);
            if (!response.ok) {
                console.log('Error playing game');
            }
            const result = await response.json();

            return result;
        }

        async function trigger() {
            document.querySelector('.play-button').classList.add('active');
            const game = await play();
            document.querySelector('.play-button').classList.remove('active');
            const { reels, win } = game;
            reels.map((reel, i) => {
                document.querySelector(`.slot${i}`).textContent = SYMBOLS[reel];
            });
            document.querySelector('.result').textContent = win ? "You're a winner!" : "Sorry, not this time!";
        };

        function setup() {
            document.querySelector('.play-button')
                .addEventListener('mousedown', trigger);
        }
        setup();

    </script>
</body>

</html>